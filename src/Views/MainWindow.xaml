<Window
    x:Class="NetDependencyWalker.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:NetDependencyWalker.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModel="clr-namespace:NetDependencyWalker.ViewModel"
    xmlns:visuals="clr-namespace:NetDependencyWalker.Visuals"
    Title=".NET Dependency Walker"
    Width="800"
    Height="450"
    d:DataContext="{d:DesignInstance viewModel:MainWindowViewModel}"
    AllowDrop="True"
    Background="White"
    Drop="MainWindow_OnDrop"
    Icon="../NetDependencyWalker.ico"
    ResizeMode="CanResizeWithGrip"
    mc:Ignorable="d">
    <Window.Resources>

        <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="{x:Type ToggleButton}">
            <Border
                x:Name="Border"
                Background="White"
                BorderBrush="#808080"
                BorderThickness="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="14" />
                    </Grid.ColumnDefinitions>
                    <Border
                        Grid.Column="0"
                        Background="White"
                        BorderBrush="#808080"
                        BorderThickness="0,0,1,0" />
                    <Path
                        x:Name="Arrow"
                        Grid.Column="1"
                        Width="10"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Data="M 0 0 L 4 4 L 8 0 Z"
                        Fill="DodgerBlue"
                        Stretch="Uniform" />
                </Grid>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="ToggleButton.IsMouseOver" Value="true">
                    <Setter TargetName="Border" Property="Background" Value="WhiteSmoke" />
                </Trigger>
                <Trigger Property="ToggleButton.IsChecked" Value="true">
                    <Setter TargetName="Border" Property="Background" Value="#E0E0E0" />
                    <Setter TargetName="Arrow" Property="Data" Value="M 0 0 L 4 -4 L 8 0 Z" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <Style TargetType="{x:Type ComboBox}">
            <Setter Property="SnapsToDevicePixels" Value="true" />
            <Setter Property="OverridesDefaultStyle" Value="true" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="ScrollViewer.CanContentScroll" Value="true" />
            <Setter Property="MinWidth" Value="120" />
            <Setter Property="MinHeight" Value="20" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid>
                            <ToggleButton
                                Name="ToggleButton"
                                ClickMode="Press"
                                Focusable="false"
                                IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                Template="{StaticResource ComboBoxToggleButton}" />
                            <ContentPresenter
                                Name="ContentSite"
                                Margin="3,3,23,3"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Content="{TemplateBinding SelectionBoxItem}"
                                ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                IsHitTestVisible="False" />
                            <Popup
                                Name="Popup"
                                AllowsTransparency="True"
                                Focusable="False"
                                IsOpen="{TemplateBinding IsDropDownOpen}"
                                Placement="Bottom"
                                PopupAnimation="Slide">
                                <Grid
                                    Name="DropDown"
                                    MinWidth="{TemplateBinding ActualWidth}"
                                    MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                    SnapsToDevicePixels="True">
                                    <Border
                                        x:Name="DropDownBorder"
                                        Background="White"
                                        BorderBrush="#888888"
                                        BorderThickness="1">
                                        <ScrollViewer SnapsToDevicePixels="True">
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" />
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasItems" Value="false">
                                <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="#888888" />
                            </Trigger>
                            <Trigger Property="IsGrouping" Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll" Value="false" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="{x:Type ComboBoxItem}">
            <Setter Property="SnapsToDevicePixels" Value="true" />
            <Setter Property="OverridesDefaultStyle" Value="true" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBoxItem}">
                        <Border
                            Name="Border"
                            Padding="2"
                            SnapsToDevicePixels="true">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="true">
                                <Setter TargetName="Border" Property="Background" Value="WhiteSmoke" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <BooleanToVisibilityConverter x:Key="VisibilityConverter" />

        <converters:AssemblyNodeToBrushConverter
            x:Key="AssemblyNodeBrushConverter"
            MajorVersionMismatchBrush="Maroon"
            MinorVersionMismatchBrush="#FFC18400"
            PatchVersionMismatchBrush="DodgerBlue"
            UnspecifiedBrush="DodgerBlue"
            VersionMatchBrush="#FF008400" />
        <converters:AssemblyNodeToGeometryConverter
            x:Key="AssemblyNodeGeometryConverter"
            MajorVersionMismatchGeometry="F1M874.0,289.3L854.3,254.6C854.0,254.1 853.5,253.8 852.9,253.8 852.4,253.8 851.8,254.1 851.6,254.6L831.8,289.3C831.5,289.8 831.5,290.4 831.8,290.8 832.1,291.3 832.6,291.6 833.1,291.6L872.7,291.6C873.2,291.6 873.8,291.3 874.0,290.8 874.3,290.4 874.3,289.8 874.0,289.3 M855.6,287.1L850.2,287.1 850.2,282.7 855.6,282.7 855.6,287.1z M855.6,279.4L850.2,279.4 850.2,266.0 855.6,266.0 855.6,279.4z"
            MinorVersionMismatchGeometry="M20.03 12C20.03 7.59 16.41 3.97 12 3.97C7.59 3.97 3.97 7.59 3.97 12C3.97 16.41 7.59 20.03 12 20.03C16.41 20.03 20.03 16.41 20.03 12M22 12C22 17.54 17.54 22 12 22C6.46 22 2 17.54 2 12C2 6.46 6.46 2 12 2C17.54 2 22 6.46 22 12M13.54 13V16L17.5 12L13.54 8V11H6.5V13"
            PatchVersionMismatchGeometry="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
            UnspecifiedGeometry="M14 2H6C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H18C19.11 22 20 21.11 20 20V8L14 2M18 20H6V4H13V9H18V20M9.54 15.65L11.63 17.74L10.35 19L7 15.65L10.35 12.3L11.63 13.56L9.54 15.65M17 15.65L13.65 19L12.38 17.74L14.47 15.65L12.38 13.56L13.65 12.3L17 15.65Z"
            VersionMatchGeometry="M14,2L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2H14M18,20V9H13V4H6V20H18M11.2,18.46L8.45,15.46L9.61,14.3L11.2,15.88L14.78,12.3L15.95,13.71L11.2,18.46Z" />

        <converters:ReferencedTypeNodeToBrushConverter
            x:Key="ReferencedTypeNodeBrushConverter"
            DefaultBrush="DimGray"
            FieldBrush="DarkBlue"
            MethodBrush="Purple"
            PropertyBrush="DarkBlue"
            TypeHierarchyBrush="Teal" />
        <converters:ReferencedTypeNodeToGeometryConverter
            x:Key="ReferencedTypeNodeGeometryConverter"
            DefaultGeometry="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M11 8H9V10C9 11.1 8.1 12 7 12C8.1 12 9 12.9 9 14V16H11V18H9C7.9 18 7 17.1 7 16V15C7 13.9 6.1 13 5 13V11C6.1 11 7 10.1 7 9V8C7 6.9 7.9 6 9 6H11V8M19 13C17.9 13 17 13.9 17 15V16C17 17.1 16.1 18 15 18H13V16H15V14C15 12.9 15.9 12 17 12C15.9 12 15 11.1 15 10V8H13V6H15C16.1 6 17 6.9 17 8V9C17 10.1 17.9 11 19 11V13Z"
            FieldGeometry="M11 11H13V13H11V11M11 7H13V9H11V7M11 15H13V17H11V15Z"
            InboundReferenceGeometry="M19,15L13,21L11.58,19.58L15.17,16H4V4H6V14H15.17L11.58,10.42L13,9L19,15Z"
            MethodGeometry="M21,16.5C21,16.88 20.79,17.21 20.47,17.38L12.57,21.82C12.41,21.94 12.21,22 12,22C11.79,22 11.59,21.94 11.43,21.82L3.53,17.38C3.21,17.21 3,16.88 3,16.5V7.5C3,7.12 3.21,6.79 3.53,6.62L11.43,2.18C11.59,2.06 11.79,2 12,2C12.21,2 12.41,2.06 12.57,2.18L20.47,6.62C20.79,6.79 21,7.12 21,7.5V16.5M12,4.15L10.11,5.22L16,8.61L17.96,7.5L12,4.15M6.04,7.5L12,10.85L13.96,9.75L8.08,6.35L6.04,7.5M5,15.91L11,19.29V12.58L5,9.21V15.91M19,15.91V9.21L13,12.58V19.29L19,15.91Z"
            OutboundReferenceGeometry="M503 11 501.58 12.42 498 8.83 498 18 508 18 508 20 496 20 496 8.83 492.42 12.42 491 11 497 5 503 11Z"
            PropertyGeometry="M19 19H15V21H19C20.1 21 21 20.1 21 19V15H19M19 3H15V5H19V9H21V5C21 3.9 20.1 3 19 3M5 5H9V3H5C3.9 3 3 3.9 3 5V9H5M5 15H3V19C3 20.1 3.9 21 5 21H9V19H5V15M11 11H13V13H11V11M11 7H13V9H11V7M11 15H13V17H11V15Z"
            TypeHierarchyGeometry="M17,20.41L18.41,19L15,15.59L13.59,17M7.5,8H11V13.59L5.59,19L7,20.41L13,14.41V8H16.5L12,3.5" />

        <HierarchicalDataTemplate DataType="{x:Type viewModel:ReferencedTypeNode}" ItemsSource="{Binding Children}">
            <Border
                Margin="0,1,0,1"
                Background="Transparent"
                BorderThickness="0"
                ToolTip="{Binding Hint}">
                <StackPanel Orientation="Horizontal">
                    <Path
                        Width="14"
                        Height="14"
                        Margin="1,1,4,1"
                        Data="{Binding Converter={StaticResource ReferencedTypeNodeGeometryConverter}}"
                        Fill="{Binding Converter={StaticResource ReferencedTypeNodeBrushConverter}}"
                        Stretch="Uniform" />
                    <TextBlock VerticalAlignment="Center">
                        <Run Text="{Binding Initial, Mode=OneTime}" /><Run FontWeight="DemiBold" Text="{Binding Secondary, Mode=OneTime}" />
                    </TextBlock>
                </StackPanel>
            </Border>
        </HierarchicalDataTemplate>

        <HierarchicalDataTemplate DataType="{x:Type viewModel:AssemblyNode}" ItemsSource="{Binding ChildNodes}">
            <StackPanel Margin="0,1,0,1" Orientation="Horizontal">
                <Canvas
                    Width="16"
                    Height="16"
                    Margin="0,0,3,0"
                    VerticalAlignment="Center"
                    Background="Transparent"
                    ToolTip="{Binding VersionMismatchPrompt}">
                    <Path
                        Canvas.Left="1"
                        Canvas.Top="1"
                        Width="14"
                        Height="14"
                        Data="{Binding Converter={StaticResource AssemblyNodeGeometryConverter}}"
                        Fill="{Binding Converter={StaticResource AssemblyNodeBrushConverter}}"
                        Stretch="Uniform" />
                </Canvas>
                <TextBlock VerticalAlignment="Center" Text="{Binding Text}" />
            </StackPanel>
        </HierarchicalDataTemplate>
    </Window.Resources>
    <visuals:LoadingContainer IsBusy="{Binding IsBusy}" Text="Please wait while inspecting the assembly dependency tree...">
        <DockPanel>
            <StatusBar
                Background="White"
                BorderBrush="White"
                BorderThickness="0"
                DockPanel.Dock="Bottom">
                <StatusBarItem>
                    <TextBlock Text="{Binding LoadingPrompt}" />
                </StatusBarItem>
            </StatusBar>

            <Grid>
                <Grid HorizontalAlignment="Center" Visibility="{Binding WaitingForFile, Converter={StaticResource VisibilityConverter}}">
                    <Grid HorizontalAlignment="Center" Visibility="{Binding NoLoadException, Converter={StaticResource VisibilityConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Path
                            Width="96"
                            Height="96"
                            Data="M7.5,15L7.5,18 25.6,18 28.0,16.5 25.5,15z M14.5,11L14.5,13 16.5,13 16.5,11z M6.1,6L3.7,7.5 6.1,9 23.5,9 23.5,6z M14.8,2L14.8,4 16.8,4 16.8,2z M12.8,0L18.8,0 18.8,4 25.5,4 25.5,11 18.5,11 18.5,13 26.1,13 31.7,16.6 26.1,20 18.5,20 18.5,32 16.5,32 16.5,20 14.5,20 14.5,32 12.5,32 12.5,20 5.5,20 5.5,13 12.5,13 12.5,11 5.6,11 0,7.6 5.5,4 12.8,4z"
                            Fill="DodgerBlue"
                            Stretch="Uniform" />

                        <Grid
                            Grid.Column="1"
                            Margin="8,0,0,0"
                            VerticalAlignment="Center">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Grid.Row="0"
                                FontFamily="Segoe UI"
                                FontSize="18"
                                FontWeight="Bold"
                                Text="Welcome to the .NET Dependency Walker" />
                            <TextBlock
                                Grid.Row="1"
                                Margin="0,4,0,0"
                                FontFamily="Segoe UI"
                                FontSize="12"
                                Text="Drop a .NET or .NET Core binary onto this window to explore it's dependencies..." />
                        </Grid>
                    </Grid>
                    <Grid HorizontalAlignment="Center" Visibility="{Binding HasLoadException, Converter={StaticResource VisibilityConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Path
                            Width="96"
                            Height="96"
                            Data="M7,4V6H10V8H7L5,10V13H3V10H1V18H3V15H5V18H8L10,20H18V16H20V19H23V9H20V12H18V8H12V6H15V4H7Z"
                            Fill="Goldenrod"
                            Stretch="Uniform" />

                        <Grid
                            Grid.Column="1"
                            Margin="8,0,0,0"
                            VerticalAlignment="Center">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Grid.Row="0"
                                FontFamily="Segoe UI"
                                FontSize="18"
                                FontWeight="Bold"
                                Text="Oh Noes!" />
                            <TextBlock
                                Grid.Row="1"
                                Margin="0,12,0,0"
                                FontFamily="Segoe UI"
                                FontSize="12">
                                <Run Text="Error while loading '" /><Run Text="{Binding RootFileNameOnly, Mode=OneWay}" /><Run Text="':" />
                            </TextBlock>
                            <TextBlock
                                Grid.Row="2"
                                Margin="12,4,0,0"
                                FontFamily="Segoe UI"
                                FontSize="12"
                                Text="{Binding LoadExceptionType}" />
                            <TextBlock
                                Grid.Row="3"
                                Margin="12,4,0,0"
                                FontFamily="Segoe UI"
                                FontSize="12"
                                Foreground="#FF777777"
                                Text="{Binding LoadExceptionMessage}" />
                            <TextBlock
                                Grid.Row="4"
                                Margin="0,12,0,0"
                                FontFamily="Segoe UI"
                                FontSize="12"
                                Text="If at first you don't succeed, try try again..." />
                            <TextBlock
                                Grid.Row="5"
                                Margin="0,4,0,0"
                                FontFamily="Segoe UI"
                                FontSize="12"
                                Text="Drop a .NET or .NET Core binary onto this window to explore it's dependencies..." />
                        </Grid>
                    </Grid>
                </Grid>
                <Grid
                    HorizontalAlignment="Center"
                    VerticalAlignment="Bottom"
                    Visibility="{Binding WaitingForFile, Converter={StaticResource VisibilityConverter}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid HorizontalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Column="0"
                            FontFamily="Segoe UI"
                            FontSize="14">
                            <Run Text="With thanks to the " /><Hyperlink Click="OpenMonoCecil">Mono.Cecil</Hyperlink><Run Text=", " /><Hyperlink Click="OpenIlSpy">ILSpy</Hyperlink><Run Text=" and " /><Hyperlink Click="OpenXUnit">xUnit</Hyperlink><Run Text=" teams" />
                        </TextBlock>
                        <Path
                            Grid.Column="1"
                            Width="24"
                            Height="24"
                            Margin="6,0,0,0"
                            Data="M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z"
                            Fill="Red"
                            Stretch="Uniform" />
                    </Grid>
                    <Grid Grid.Row="1" HorizontalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Path
                            Grid.Column="0"
                            Width="24"
                            Height="24"
                            Margin="0,0,6,0"
                            Data="M12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2C17.5,2 22,6 22,11A6,6 0 0,1 16,17H14.2C13.9,17 13.7,17.2 13.7,17.5C13.7,17.6 13.8,17.7 13.8,17.8C14.2,18.3 14.4,18.9 14.4,19.5C14.5,20.9 13.4,22 12,22M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C12.3,20 12.5,19.8 12.5,19.5C12.5,19.3 12.4,19.2 12.4,19.1C12,18.6 11.8,18.1 11.8,17.5C11.8,16.1 12.9,15 14.3,15H16A4,4 0 0,0 20,11C20,7.1 16.4,4 12,4M6.5,10C7.3,10 8,10.7 8,11.5C8,12.3 7.3,13 6.5,13C5.7,13 5,12.3 5,11.5C5,10.7 5.7,10 6.5,10M9.5,6C10.3,6 11,6.7 11,7.5C11,8.3 10.3,9 9.5,9C8.7,9 8,8.3 8,7.5C8,6.7 8.7,6 9.5,6M14.5,6C15.3,6 16,6.7 16,7.5C16,8.3 15.3,9 14.5,9C13.7,9 13,8.3 13,7.5C13,6.7 13.7,6 14.5,6M17.5,10C18.3,10 19,10.7 19,11.5C19,12.3 18.3,13 17.5,13C16.7,13 16,12.3 16,11.5C16,10.7 16.7,10 17.5,10Z"
                            Fill="#FF008400"
                            Stretch="Uniform" />
                        <TextBlock
                            Grid.Column="1"
                            FontFamily="Segoe UI"
                            FontSize="14">
                            <Run Text="Iconography from" />
                            <Hyperlink Click="OpenMaterialDesignIcons">materialdesignicons.com</Hyperlink>
                        </TextBlock>
                    </Grid>

                </Grid>

                <Grid Visibility="{Binding HasFile, Converter={StaticResource VisibilityConverter}}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Grid
                            Grid.Row="0"
                            Margin="4"
                            HorizontalAlignment="Stretch">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Path
                                Width="24"
                                Height="24"
                                Margin="0,0,4,0"
                                Data="M14 2H6C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H18C19.11 22 20 21.11 20 20V8L14 2M18 20H6V4H13V9H18V20M9.54 15.65L11.63 17.74L10.35 19L7 15.65L10.35 12.3L11.63 13.56L9.54 15.65M17 15.65L13.65 19L12.38 17.74L14.47 15.65L12.38 13.56L13.65 12.3L17 15.65Z"
                                Fill="DodgerBlue"
                                Stretch="Uniform" />

                            <StackPanel
                                Grid.Column="1"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,4,0"
                                    FontFamily="Segoe UI"
                                    FontSize="12"
                                    Text="Inspecting:" />
                                <TextBlock
                                    FontFamily="Segoe UI"
                                    FontSize="12"
                                    Text="{Binding RootFileNameOnly, Mode=OneWay}"
                                    ToolTip="{Binding RootFileName, Mode=OneWay}" />
                                <TextBlock
                                    Margin="4,0,0,0"
                                    FontFamily="Segoe UI"
                                    FontSize="12"
                                    Foreground="#606060"
                                    Visibility="{Binding RootTargetFrameworkKnown, Converter={StaticResource VisibilityConverter}}">
                                    <Run Text="(" /><Run Text="{Binding RootTargetFramework, Mode=OneWay}" /><Run Text=")" />
                                </TextBlock>
                            </StackPanel>


                            <visuals:FlatButton
                                Grid.Column="2"
                                Width="28"
                                Height="28"
                                Margin="4,0"
                                Command="{Binding UseMonoWalkingCommand}"
                                HighlightShown="{Binding UsingMonoWalking}"
                                Path="F1 M 21.3,17.4L 54.6,17.4C 56.8,17.4 58.5,19.1 58.5,21.3L 58.5,54.6C 58.5,56.8 56.8,58.5 54.6,58.5L 21.3,58.5C 21.0,58.5 20.6,58.5 20.3,58.4L 20.4,58.3L 27.2,50.4L 28.8,48.4L 29.3,47.9L 29.4,47.8C 31.1,47.9 32.6,49.0 34.2,49.6C 36.7,50.5 39.1,51.7 41.5,52.7L 44.5,54.0L 45.0,54.2L 45.6,54.5L 46.2,54.7L 46.5,54.6L 46.6,54.3L 46.9,53.7C 47.4,53.0 47.7,52.3 48.0,51.5L 48.2,51.0L 48.5,50.4L 48.7,49.9L 48.8,49.6L 48.6,49.4L 48.1,49.2L 47.5,48.8C 46.7,48.3 45.9,47.7 45.2,47.0C 44.2,46.1 43.4,44.9 42.6,43.7L 41.7,42.3C 41.5,42.0 41.4,41.6 41.5,41.2C 42.2,41.4 42.5,42.1 42.9,42.6C 43.5,43.3 44.2,44.0 44.9,44.6L 46.5,45.9L 47.5,46.7L 47.8,47.0L 48.1,47.3L 48.4,47.3L 48.9,47.8L 49.2,47.8L 49.4,47.7C 49.6,47.3 49.6,46.8 49.6,46.3C 49.9,45.1 49.9,43.9 49.7,42.6C 49.7,42.0 49.9,41.4 49.7,40.8L 49.5,40.6L 49.5,40.0L 49.4,39.5L 49.2,39.3L 49.2,38.8L 49.2,38.4L 48.5,36.1L 48.3,35.6C 48.2,35.5 48.2,35.2 48.1,35.1C 47.9,35.0 47.7,35.0 47.5,34.9L 45.8,34.4L 43.6,33.7L 43.0,33.5C 42.9,33.4 42.6,33.4 42.5,33.3C 42.5,33.1 42.6,33.0 42.6,32.8C 43.7,32.9 44.7,33.2 45.8,33.4L 47.4,33.7C 48.2,33.9 49.0,34.1 49.7,33.9C 50.0,33.8 50.0,33.4 50.0,33.1C 50.1,31.6 49.7,30.0 49.3,28.5C 48.9,27.3 48.7,25.9 47.9,24.9C 47.4,24.4 46.6,24.3 45.9,24.1C 44.5,23.7 43.0,23.3 41.5,23.1L 41.0,23.1L 40.4,23.1L 40.2,22.9C 39.6,22.7 39.0,23.0 38.4,22.8L 38.1,22.7C 37.6,22.5 37.0,22.6 36.4,22.6C 35.5,22.6 34.6,22.6 33.7,22.7C 32.8,22.9 31.7,22.7 31.0,23.2L 33.2,23.7C 33.9,23.8 34.7,23.8 35.2,24.3C 34.9,24.8 34.1,24.6 33.5,24.5C 32.6,24.5 31.7,24.3 30.8,24.1C 30.0,24.0 29.2,23.9 28.4,23.8L 27.8,23.8L 27.3,23.8L 27.1,23.6C 26.5,23.5 25.9,23.4 25.4,23.6C 25.0,23.7 24.8,24.2 24.6,24.5C 24.2,25.0 23.8,25.4 23.6,25.9C 23.3,26.6 23.2,27.4 23.5,28.1C 24.1,29.6 25.6,30.7 27.1,31.5L 29.7,32.8C 30.2,33.1 30.8,33.2 31.1,33.6C 31.2,33.7 31.1,33.9 31.0,34.0C 29.5,33.8 28.1,32.9 26.6,32.4L 26.2,32.2L 25.7,32.1L 17.4,35.3L 17.4,21.3C 17.4,19.1 19.1,17.4 21.3,17.4 Z"
                                ToolTip="Use walking algorithm based on Mono.Cecil and ILSpy" />

                            <visuals:FlatButton
                                Grid.Column="3"
                                Width="28"
                                Height="28"
                                Margin="0,0,4,0"
                                Command="{Binding UseNativeWalkingCommand}"
                                HighlightShown="{Binding UsingNativeWalking}"
                                Path="M11.5,15.9L11.9,18.4C11.6,18.5 11.2,18.6 10.6,18.8C10.1,18.9 9.4,19 8.6,19C6.4,18.9 4.7,18.3 3.6,17.0C2.5,15.7 2,14.1 2,12.2C2.0,9.9 2.7,8.1 4,6.8C5.3,5.6 6.9,5 8.9,5C9.6,5 10.3,5.0 10.8,5.1C11.4,5.3 11.8,5.4 12.0,5.5L11.5,8.0L10.4,7.7C10.0,7.6 9.5,7.5 9.0,7.5C7.8,7.5 6.9,7.9 6.1,8.6C5.4,9.4 5.0,10.5 5,12.0C5,13.3 5.3,14.4 6.0,15.2C6.7,16 7.7,16.4 9.0,16.4L10.4,16.2C10.8,16.2 11.1,16.1 11.5,15.9M13.8,19L14.5,15H13L13.3,13H14.8L15.1,11H13.6L14,9H15.5L16.1,5H18.1L17.5,9H18.5L19.1,5H21.1L20.5,9H22L21.6,11H20.1L19.8,13H21.3L21,15H19.5L18.8,19H16.8L17.5,15H16.5L15.8,19H13.8M16.8,13H17.8L18.1,11H17.1L16.8,13Z"
                                ToolTip="Use native .net based walking algorithm" />

                            <visuals:FlatButton
                                Grid.Column="4"
                                Width="28"
                                Height="28"
                                Margin="0,0,4,0"
                                Command="{Binding ToggleFilterCommand}"
                                HighlightShown="{Binding IsFiltered}"
                                Path="M14,12V19.88C14.04,20.18 13.94,20.5 13.71,20.71C13.32,21.1 12.69,21.1 12.3,20.71L10.29,18.7C10.06,18.47 9.96,18.16 10,17.87V12H9.97L4.21,4.62C3.87,4.19 3.95,3.56 4.38,3.22C4.57,3.08 4.78,3 5,3V3H19V3C19.22,3 19.43,3.08 19.62,3.22C20.05,3.56 20.13,4.19 19.79,4.62L14.03,12H14Z"
                                ToolTip="Filter" />

                            <visuals:FlatButton
                                Grid.Column="5"
                                Width="28"
                                Height="28"
                                Command="{Binding RefreshCommand}"
                                Path="M2.74,30.29L18.66,37.69 14.34,40.72C17.78,43.70 22.16,45.56 26.79,45.56 35.68,45.56 43.46,39.75 45.30,31.28L45.59,30.63 53.33,30.63 52.97,31.94C50.75,44.41 39.74,52.77 26.79,52.77 19.53,52.77 12.80,49.89 7.87,44.93L4.24,47.38z M26.53,0C33.80,-6.85E-08,40.52,2.76,45.45,7.72L49.08,5.05 50.58,21.70 34.66,15.29 38.98,12.36C35.54,9.38 31.16,7.73 26.53,7.73 17.64,7.73 9.86,13.92 8.02,22.40L7.73,23.83 0,23.83 0.35,21.68C2.57,9.21,13.58,-6.85E-08,26.53,0z"
                                ToolTip="Reload" />
                        </Grid>

                        <Grid
                            Grid.Row="1"
                            Margin="4"
                            HorizontalAlignment="Stretch"
                            Visibility="{Binding FilterVisible, Converter={StaticResource VisibilityConverter}}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                VerticalAlignment="Center"
                                FontFamily="Segoe UI"
                                FontSize="12"
                                Text="Filter:" />

                            <TextBox
                                Grid.Column="1"
                                Margin="4,0,0,0"
                                FontFamily="Segoe UI"
                                FontSize="12"
                                Text="{Binding FilterText, Delay=300, UpdateSourceTrigger=PropertyChanged}" />

                        </Grid>

                        <TabControl
                            x:Name="TabControl"
                            Grid.Row="2"
                            Margin="0,0,0,-3"
                            BorderThickness="0,1,0,0">
                            <TabItem>
                                <TabItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path
                                            Width="14"
                                            Height="14"
                                            Margin="1,1,4,1"
                                            Data="M7,5H21V7H7V5M7,13V11H21V13H7M4,4.5A1.5,1.5 0 0,1 5.5,6A1.5,1.5 0 0,1 4,7.5A1.5,1.5 0 0,1 2.5,6A1.5,1.5 0 0,1 4,4.5M4,10.5A1.5,1.5 0 0,1 5.5,12A1.5,1.5 0 0,1 4,13.5A1.5,1.5 0 0,1 2.5,12A1.5,1.5 0 0,1 4,10.5M7,19V17H21V19H7M4,16.5A1.5,1.5 0 0,1 5.5,18A1.5,1.5 0 0,1 4,19.5A1.5,1.5 0 0,1 2.5,18A1.5,1.5 0 0,1 4,16.5Z"
                                            Fill="DodgerBlue"
                                            Stretch="Uniform" />
                                        <TextBlock Grid.Column="1" FontFamily="Segoe UI">
                                            <Run Text="Reference list" /><Run Text="{Binding ReferenceListCount}" />
                                        </TextBlock>
                                    </Grid>
                                </TabItem.Header>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Grid Margin="4,2,4,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Margin="0,1,4,0" Text="Find:" />
                                        <TextBox Grid.Column="1" Text="{Binding ReferencedAssembliesSearchTerm, UpdateSourceTrigger=PropertyChanged}" />
                                    </Grid>
                                    <ListBox
                                        Grid.Row="1"
                                        FontFamily="Segoe UI"
                                        FontSize="12"
                                        ItemsSource="{Binding ReferencedAssemblies}">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="5" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Rectangle
                                                        Grid.Column="0"
                                                        Width="1"
                                                        Margin="2,4"
                                                        Fill="DodgerBlue" />
                                                    <StackPanel
                                                        Grid.Column="1"
                                                        Margin="3,0,0,0"
                                                        Orientation="Vertical">
                                                        <TextBlock FontFamily="Segoe UI" FontSize="12">
                                                            <Run FontWeight="DemiBold" Text="{Binding Name, Mode=OneTime}" /><Run Text=" (" /><Run Text="{Binding Version, Mode=OneTime}" /><Run Text=")" />
                                                        </TextBlock>
                                                        <TextBlock
                                                            FontFamily="Segoe UI"
                                                            FontSize="10"
                                                            Foreground="Gray"
                                                            Text="{Binding Path}" />
                                                    </StackPanel>
                                                </Grid>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Grid>
                            </TabItem>
                            <TabItem>
                                <TabItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path
                                            Width="14"
                                            Height="14"
                                            Margin="1,1,4,1"
                                            Data="M19,15L13,21L11.58,19.58L15.17,16H4V4H6V14H15.17L11.58,10.42L13,9L19,15Z"
                                            Fill="DodgerBlue"
                                            Stretch="Uniform" />
                                        <TextBlock
                                            Grid.Column="1"
                                            FontFamily="Segoe UI"
                                            Text="Forward tree" />
                                    </Grid>
                                </TabItem.Header>
                                <TreeView
                                    x:Name="ForwardNodeTree"
                                    FontFamily="Segoe UI"
                                    FontSize="12"
                                    ItemsSource="{Binding ForwardRootNodes}">
                                    <TreeView.ItemContainerStyle>
                                        <Style TargetType="{x:Type TreeViewItem}">
                                            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
                                        </Style>
                                    </TreeView.ItemContainerStyle>
                                </TreeView>
                            </TabItem>
                            <TabItem x:Name="ReverseTreeTabItem">
                                <TabItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path
                                            Width="14"
                                            Height="14"
                                            Margin="1,1,4,1"
                                            Data="M503 11 501.58 12.42 498 8.83 498 18 508 18 508 20 496 20 496 8.83 492.42 12.42 491 11 497 5 503 11Z"
                                            Fill="DodgerBlue"
                                            Stretch="Uniform" />
                                        <TextBlock
                                            Grid.Column="1"
                                            FontFamily="Segoe UI"
                                            Text="Reverse tree" />
                                    </Grid>
                                </TabItem.Header>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Grid Margin="4,2,4,5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Margin="0,1,4,0" Text="Find:" />
                                        <TextBox Grid.Column="1" Text="{Binding ReverseNodesSearchTerm, UpdateSourceTrigger=PropertyChanged}" />
                                    </Grid>
                                    <TreeView
                                        x:Name="ReverseTree"
                                        Grid.Row="1"
                                        FontFamily="Segoe UI"
                                        FontSize="12"
                                        ItemsSource="{Binding ReverseRootNodes}">
                                        <TreeView.ItemContainerStyle>
                                            <Style TargetType="{x:Type TreeViewItem}">
                                                <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
                                            </Style>
                                        </TreeView.ItemContainerStyle>
                                    </TreeView>
                                </Grid>

                            </TabItem>
                            <TabItem>
                                <TabItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path
                                            Width="14"
                                            Height="14"
                                            Margin="1,1,4,1"
                                            Data="M16 0H8C6.9 0 6 .9 6 2V18C6 19.1 6.9 20 8 20H20C21.1 20 22 19.1 22 18V6L16 0M20 18H8V2H15V7H20V18M4 4V22H20V24H4C2.9 24 2 23.1 2 22V4H4Z"
                                            Fill="DarkGoldenrod"
                                            Stretch="Uniform" />
                                        <TextBlock Grid.Column="1" FontFamily="Segoe UI">
                                            <Run Text="Multiple versions" /><Run Text="{Binding MultipleVersionsCount}" />
                                        </TextBlock>
                                    </Grid>
                                </TabItem.Header>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <CheckBox Margin="4,2,4,5" IsChecked="{Binding ListOnlyMajorVersionMismatches}">Show only major version mismatches</CheckBox>
                                    <ListBox
                                        x:Name="MultipleVersionsList"
                                        Grid.Row="1"
                                        Grid.IsSharedSizeScope="True"
                                        ItemsSource="{Binding MultipleVersionNodes}"
                                        MouseDoubleClick="MultipleVersionsListMouseDoubleClick">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="5" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Rectangle
                                                        Grid.Column="0"
                                                        Width="1"
                                                        Margin="2,4"
                                                        Fill="{Binding Converter={StaticResource AssemblyNodeBrushConverter}}" />
                                                    <Border
                                                        Grid.Column="1"
                                                        Background="Transparent"
                                                        BorderThickness="0"
                                                        ToolTip="{Binding MismatchDescription}">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" />
                                                                <ColumnDefinition Width="Auto" SharedSizeGroup="LoadedVersion" />
                                                                <ColumnDefinition Width="Auto" SharedSizeGroup="RequestedVersions" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto" />
                                                                <RowDefinition Height="Auto" />
                                                            </Grid.RowDefinitions>
                                                            <Path
                                                                Grid.RowSpan="2"
                                                                Grid.Column="0"
                                                                Width="18"
                                                                Height="18"
                                                                Margin="3,4,3,0"
                                                                VerticalAlignment="Top"
                                                                Data="{Binding Converter={StaticResource AssemblyNodeGeometryConverter}}"
                                                                Fill="{Binding Converter={StaticResource AssemblyNodeBrushConverter}}"
                                                                Stretch="Uniform" />
                                                            <TextBlock
                                                                Grid.Row="0"
                                                                Grid.Column="1"
                                                                Grid.ColumnSpan="3"
                                                                Margin="3,0,0,0"
                                                                FontFamily="Segoe UI"
                                                                FontSize="12"
                                                                FontWeight="DemiBold"
                                                                Text="{Binding Name}" />
                                                            <StackPanel
                                                                Grid.Row="1"
                                                                Grid.Column="1"
                                                                Margin="3,0,0,0"
                                                                Orientation="Vertical">
                                                                <TextBlock
                                                                    FontFamily="Segoe UI"
                                                                    FontSize="12"
                                                                    Text="Loaded:" />
                                                                <TextBlock
                                                                    FontFamily="Segoe UI"
                                                                    FontSize="10"
                                                                    Text="{Binding LoadedVersion}" />
                                                            </StackPanel>
                                                            <StackPanel
                                                                Grid.Row="1"
                                                                Grid.Column="2"
                                                                Margin="18,0,0,0"
                                                                Orientation="Vertical">
                                                                <TextBlock
                                                                    FontFamily="Segoe UI"
                                                                    FontSize="12"
                                                                    Text="Referenced:" />
                                                                <ItemsControl ItemsSource="{Binding Versions}">
                                                                    <ItemsControl.ItemTemplate>
                                                                        <DataTemplate>
                                                                            <TextBlock
                                                                                FontFamily="Segoe UI"
                                                                                FontSize="10"
                                                                                Text="{Binding}" />
                                                                        </DataTemplate>
                                                                    </ItemsControl.ItemTemplate>
                                                                </ItemsControl>
                                                            </StackPanel>
                                                        </Grid>
                                                    </Border>
                                                </Grid>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Grid>
                            </TabItem>
                            <TabItem>
                                <TabItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path
                                            Width="14"
                                            Height="14"
                                            Margin="1,1,4,1"
                                            Data="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z"
                                            Fill="Maroon"
                                            Stretch="Uniform" />
                                        <TextBlock Grid.Column="1" FontFamily="Segoe UI">
                                            <Run Text="Load errors" /><Run Text="{Binding LoadErrorsCount}" />
                                        </TextBlock>
                                    </Grid>
                                </TabItem.Header>
                                <ListBox ItemsSource="{Binding ErrorRootNodes}">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="5" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <Rectangle
                                                    Grid.Column="0"
                                                    Width="1"
                                                    Margin="2,4"
                                                    Fill="Maroon" />
                                                <StackPanel
                                                    Grid.Column="1"
                                                    Margin="3,0,0,0"
                                                    Orientation="Vertical">
                                                    <TextBlock
                                                        FontFamily="Segoe UI"
                                                        FontSize="12"
                                                        FontWeight="DemiBold"
                                                        Text="{Binding Name}" />
                                                    <ItemsControl ItemsSource="{Binding Errors}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <TextBlock
                                                                    FontFamily="Segoe UI"
                                                                    FontSize="10"
                                                                    Text="{Binding}" />
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </StackPanel>
                                            </Grid>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </TabItem>
                            <TabItem>
                                <TabItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path
                                            Width="14"
                                            Height="14"
                                            Margin="1,1,4,1"
                                            Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"
                                            Fill="#FF008400"
                                            Stretch="Uniform" />
                                        <TextBlock
                                            Grid.Column="1"
                                            FontFamily="Segoe UI"
                                            Text="Type Dependencies" />
                                    </Grid>
                                </TabItem.Header>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Text="From:" />
                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Text="To:" />
                                    <TextBlock
                                        Grid.Row="0"
                                        Grid.Column="2"
                                        Text="Order:" />
                                    <ComboBox
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        Margin="0,2,1,2"
                                        IsReadOnly="True"
                                        ItemsSource="{Binding ReferencedAssemblies}"
                                        SelectedItem="{Binding SelectedInspectionSource}" />
                                    <ComboBox
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Margin="1,2,1,2"
                                        IsReadOnly="True"
                                        ItemsSource="{Binding AvailableInspectionTargets}"
                                        SelectedItem="{Binding SelectedInspectionTarget}" />
                                    <ComboBox
                                        Grid.Row="1"
                                        Grid.Column="2"
                                        Margin="1,2,0,2"
                                        IsReadOnly="True"
                                        ItemsSource="{Binding AvailableInspectionOrderings}"
                                        SelectedItem="{Binding SelectedInspectionOrdering}" />
                                    <TreeView
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        FontFamily="Segoe UI"
                                        FontSize="12"
                                        ItemsSource="{Binding ReferencedTypes}" />
                                    <Grid
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        Margin="100,0"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Visibility="{Binding NoInspectionTargetSelected, Converter={StaticResource VisibilityConverter}}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Path
                                            Grid.Column="0"
                                            Width="48"
                                            Height="48"
                                            Margin="0,0,12,0"
                                            Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"
                                            Fill="#FF008400"
                                            Stretch="Uniform" />
                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            FontFamily="Segoe UI"
                                            FontSize="14"
                                            TextWrapping="Wrap">
                                            <Run FontWeight="DemiBold" Text="Select both a source and target" /><LineBreak />
                                            <Run Text="Select a target assembly above to show type dependencies from the source assembly to the target assembly" />
                                        </TextBlock>
                                    </Grid>
                                    <Grid
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="3"
                                        Margin="100,0"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Visibility="{Binding NoDirectReferencesFound, Converter={StaticResource VisibilityConverter}}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Path
                                            Grid.Column="0"
                                            Width="48"
                                            Height="48"
                                            Margin="0,0,12,0"
                                            Data="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z"
                                            Fill="#FFb0b0b0"
                                            Stretch="Uniform" />
                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            FontFamily="Segoe UI"
                                            FontSize="14"
                                            TextWrapping="Wrap"
                                            Visibility="{Binding NoDirectReferencesFound, Converter={StaticResource VisibilityConverter}}">
                                            <Run FontWeight="DemiBold" Text="No direct references were found" /><LineBreak />
                                            <Run Text="From: " /><Run Text="{Binding SelectedInspectionSource.IdentityName, Mode=OneWay}" /><LineBreak />
                                            <Run Text="To: " /><Run Text="{Binding SelectedInspectionTarget.IdentityName, Mode=OneWay}" />
                                        </TextBlock>
                                    </Grid>

                                </Grid>
                            </TabItem>
                        </TabControl>
                    </Grid>
                </Grid>
            </Grid>
        </DockPanel>
    </visuals:LoadingContainer>
</Window>
